# go-conv

根据函数类型声明自动生成转换函数

# Feature

- [x] 自动处理同名包
- [ ] 避免生成的函数和包内函数名冲突
- [x] 支持embed struct
- [x] 支持自定义基础类型自动强转
- [x] 支持Alias类型自动转换
- [x] 支持基础类型自动转型
- [x] 支持string <-> []byte/[]rune 互转
- [x] 支持自引用对象
- [x] 支持Pointer <-> Struct 互转
- [x] 支持Array <-> Slice 互转
- [x] 支持conv/deepCopy模式
- [ ] 支持扩展自定义转换函数
- [x] 支持自动解指针
- [ ] 支持interface{}类型
- [ ] 支持chan类型

# Example

## conv模式

conv模式是默认使用的类型转换模式，采用浅拷贝，提高转换性能

```go
// go-conv:generate
var Foo2Bar func (src *Foo) *Bar

type Foo struct {
    Str     string
    Slice   []string
    Map     map[string]string
    Pointer string
    Alias   string
}

type Bar struct {
    Str     string
    Slice   []string
    Map     map[string]string
    Pointer *string
    Alias   StringAlias
}

type StringAlias string
```

generated:

```go
// Code generated by github.com/ycl2018/go-conv DO NOT EDIT.

package testdata

func FooToBar(src *Foo) (dst *Bar) {
	if src != nil {
		dst = new(Bar)
		dst.Str = src.Str
		dst.Slice = src.Slice
		dst.Map = src.Map
		dst.Pointer = &src.Pointer
		dst.Alias = (StringAlias)(src.Alias)
	}
	return
}
func init() {
	Foo2Bar = FooToBar
}
```

## copy模式

conv模式使用深拷贝模式转换结构体的每个字段

```go
// go-conv:generate
// go-conv:copy
var Foo2Bar func(src *Foo) *Bar

type Foo struct {
	Str     string
	Slice   []string
	Map     map[string]string
	Pointer string
	Alias   string
}

type Bar struct {
	Str     string
	Slice   []string
	Map     map[string]string
	Pointer *string
	Alias   StringAlias
}

type StringAlias string
```

generated:

```go
// Code generated by github.com/ycl2018/go-conv DO NOT EDIT.

package testdata

func CopyFooToBar(src *Foo) (dst *Bar) {
	if src != nil {
		dst = new(Bar)
		dst.Str = src.Str
		if len(src.Slice) > 0 {
			dst.Slice = make([]string, len(src.Slice))
			for i := 0; i < len(src.Slice); i++ {
				dst.Slice[i] = src.Slice[i]
			}
		}
		if len(src.Map) > 0 {
			dst.Map = make(map[string]string, len(src.Map))
			for k, v := range src.Map {
				var tmpK string
				var tmpV string
				tmpK = k
				tmpV = v
				dst.Map[tmpK] = tmpV
			}
		}
		dst.Pointer = new(string)
		*dst.Pointer = src.Pointer
		dst.Alias = StringAlias(src.Alias)
	}
	return
}
func init() {
	Foo2Bar = CopyFooToBar
}
```